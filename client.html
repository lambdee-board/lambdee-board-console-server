<html>
  <head>
    <script>
      function init() {
        function appendText(element, string) {
          let p = document.createElement("pre");
          p.appendChild(document.createTextNode(string));
          element.appendChild(p);
        }

        function debug(string) {
          let element = document.getElementById("debug");
          appendText(element, string)
        }

        function consolePrint(string) {
          let element = document.getElementById("console-output");
          appendText(element, string)
        }

        var ws = new WebSocket("ws://localhost:8080/foo/bar?hello=world");
        ws.onmessage = function(evt) {
          debug("Received: " + evt.data);
          consolePrint(evt.data)
        };
        ws.onclose = function(event) {
          debug("Closed - code: " + event.code + ", reason: " + event.reason + ", wasClean: " + event.wasClean);
        };
        ws.onopen = function() {
          debug("connected...");
        };

        document.getElementById('console-input-button').addEventListener('click', () => {
          let consoleInput = document.getElementById('console-input')
          let code = consoleInput.value
          consoleInput.value = ''

          ws.send(code)
        })
      };

    </script>
  </head>
  <body onload="init();">
    <div style="display: flex;">
      <div id="console-pane" style="width: 70%">
        <div id="console-output"></div>
        <textarea id="console-input" style="width: calc(100% - 8px); margin: 4px;"></textarea>
        <button id="console-input-button">Eval</button>
      </div>

      <div id="debug"></div>
    </div>
  </body>
</html>
